<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Kitchen Order Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{font-family:'Segoe UI',sans-serif;background:#1e1e1e;color:#fff;margin:0;padding:20px}
h1{text-align:center;font-size:2.2em}
.section{background:#2a2a2a;padding:16px;margin:16px auto;max-width:1100px;border-radius:14px}
.order{background:#333;border-radius:12px;padding:14px;margin-bottom:12px}
.tag{display:inline-block;padding:4px 10px;border-radius:20px;font-size:.85em;margin-right:6px}
.waiting{background:#7f8c8d}
.progress{background:#e67e22}
.complete{background:#27ae60}
button{padding:6px 10px;border-radius:8px;border:none;cursor:pointer;margin-right:6px}
.waitBtn{background:#7f8c8d;color:#fff}
.progBtn{background:#e67e22;color:#fff}
.doneBtn{background:#27ae60;color:#fff}
</style>
</head>

<body>

<div style="text-align:center;margin-bottom:12px">
  <a href="index.html"><button>â¬… Back to Family Page</button></a>
</div>

<h1>ğŸ³ Kitchen Order Board</h1>

<div class="section">
<h2>ğŸ§¾ Active Orders</h2>
<div id="activeOrders"></div>
</div>

<div class="section">
<h2>âœ… Completed Orders</h2>
<div id="completedOrders"></div>
</div>

<script>
firebase.initializeApp({
  apiKey: "AIzaSyCMe7NS2qyLydIRuCb8jPSZLtL0h40afuo",
  authDomain: "family-order-4e07a.firebaseapp.com",
  databaseURL: "https://family-order-4e07a-default-rtdb.firebaseio.com",
  projectId: "family-order-4e07a",
  storageBucket: "family-order-4e07a.firebasestorage.app",
  messagingSenderId: "458217288852",
  appId: "1:458217288852:web:a5a96c700c294fd299b081"
});

const db = firebase.database().ref("family-order");
const activeOrders = document.getElementById("activeOrders");
const completedOrders = document.getElementById("completedOrders");

db.on("value", snap=>{
  const data = snap.val();
  if(!data || !data.people || !data.ingredients) return;

  activeOrders.innerHTML="";
  completedOrders.innerHTML="";

  Object.entries(data.people).forEach(([pid,p])=>{
    const items = Object.entries(p.items||{})
      .filter(([,v])=>v)
      .map(([iid])=>data.ingredients[iid]?.name)
      .filter(Boolean);

    const status = p.status || "waiting";

    const card = document.createElement("div");
    card.className="order";
    card.innerHTML=`
      <h3>${p.name}</h3>
      <div>${items.join(", ") || "No ingredients selected"}</div>
      <div style="margin:8px 0">
        <span class="tag ${status}">
          ${status==="waiting"?"ğŸ•’ Waiting":status==="progress"?"ğŸ”¥ In Progress":"âœ… Complete"}
        </span>
      </div>
      <div>
        <button class="waitBtn" onclick="setStatus('${pid}','waiting')">Waiting</button>
        <button class="progBtn" onclick="setStatus('${pid}','progress')">In Progress</button>
        <button class="doneBtn" onclick="setStatus('${pid}','complete')">Complete</button>
      </div>
    `;

    (status==="complete"?completedOrders:activeOrders).appendChild(card);
  });
});

function setStatus(pid,status){
  db.child("people").child(pid).child("status").set(status);
}
</script>

</body>
</html>
