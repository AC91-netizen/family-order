<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Family Order Board</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<!-- Firebase compat -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<style>
body{
  font-family:'Segoe UI',sans-serif;
  background:linear-gradient(135deg,#ffecd2,#fcb69f);
  margin:0;padding:20px
}
h1{text-align:center;font-size:2.5em}
.section{
  background:#fff;
  padding:15px;
  margin:15px auto;
  max-width:1100px;
  border-radius:14px;
  box-shadow:0 6px 20px rgba(0,0,0,.1)
}
.person{
  background:#fafafa;
  border-radius:12px;
  padding:12px;
  margin:12px 0;
  box-shadow:0 3px 10px rgba(0,0,0,.08)
}
button{
  background:#ff7a18;
  border:none;
  color:#fff;
  padding:6px 12px;
  border-radius:8px;
  cursor:pointer;
  margin:4px
}
button.secondary{background:#999}
button.danger{background:#d9534f}
button:active{transform:scale(.97)}
.status{font-weight:bold;margin-top:6px}
.completed{opacity:.6;text-decoration:line-through}
input{padding:6px;border-radius:6px;border:1px solid #ccc}
</style>
</head>

<body>

<h1 contenteditable="true" id="title">ğŸ” Family Order Board</h1>

<div class="section">
<h2>ğŸ‘¨â€ğŸ³ Chef Controls</h2>
<input type="password" id="pin" placeholder="Chef PIN">
<button onclick="unlockChef()">Unlock</button>
<span id="chefStatus"></span>
</div>

<div class="section">
<h2>ğŸ¥— Ingredients</h2>
<input id="newIngredient" placeholder="Add ingredient">
<button onclick="addIngredient()">Add</button>
<div id="ingredientList"></div>
</div>

<div class="section">
<h2>ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ Family Orders</h2>
<input id="newPerson" placeholder="Add person">
<button onclick="addPerson()">Add Person</button>
<div id="people"></div>
</div>

<div class="section">
<h2>âœ… Completed Orders</h2>
<div id="completed"></div>
</div>

<script>
const firebaseConfig = {
  apiKey: "AIzaSyDC8KLBdJ_eKxmGgUxvkMYL0FTK9b3V0UU",
  authDomain: "family-order-board-e0194.firebaseapp.com",
  databaseURL: "https://family-order-board-e0194-default-rtdb.firebaseio.com",
  projectId: "family-order-board-e0194",
  storageBucket: "family-order-board-e0194.firebasestorage.app",
  messagingSenderId: "171957463704",
  appId: "1:171957463704:web:1ea720f263998104107eed"
};

firebase.initializeApp(firebaseConfig);
const db = firebase.database().ref("orders");

let chefUnlocked=false;
let state={
 title:"ğŸ” Family Order Board",
 ingredients:["Beef","Chicken","Cheese","Bacon","Hash Browns","Coleslaw","Sweet Chilli","Hot Chilli","Pickled Onion Mayo"],
 people:{}
};

function save(){ db.set(state); }

db.on("value",snap=>{
 if(snap.exists()) state=snap.val();
 render();
});

function unlockChef(){
 if(document.getElementById("pin").value==="1234"){
  chefUnlocked=true;
  document.getElementById("chefStatus").innerText=" ğŸ”“ Unlocked";
 }
}

function addIngredient(){
 if(!chefUnlocked) return alert("Chef locked");
 const v=newIngredient.value.trim();
 if(!v) return;
 state.ingredients.push(v);
 newIngredient.value="";
 save();
}

function addPerson(){
 const name=newPerson.value.trim();
 if(!name) return;
 const id=Date.now();
 state.people[id]={name,items:{},status:"Waiting",done:false};
 newPerson.value="";
 save();
}

function toggleItem(pid,item){
 state.people[pid].items[item]=!state.people[pid].items[item];
 save();
}

function setStatus(pid,status){
 state.people[pid].status=status;
 if(status==="Complete") state.people[pid].done=true;
 save();
}

function removePerson(pid){
 if(confirm("Remove this person?")){
  delete state.people[pid];
  save();
 }
}

function render(){
 title.innerText=state.title;

 ingredientList.innerHTML="";
 state.ingredients.forEach(i=>{
  ingredientList.innerHTML+=`<span>â€¢ ${i} </span>`;
 });

 people.innerHTML="";
 completed.innerHTML="";

 Object.entries(state.people).forEach(([id,p])=>{
  if(p.done){
   completed.innerHTML+=`<div class="completed">${p.name}</div>`;
   return;
  }

  let html=`<div class="person"><strong>${p.name}</strong>`;
  state.ingredients.forEach(i=>{
   const c=p.items[i]?"checked":"";
   html+=`<div><input type="checkbox" ${c} onclick="toggleItem(${id},'${i}')"> ${i}</div>`;
  });
  html+=`
   <div class="status">${p.status}</div>
   <button onclick="setStatus(${id},'Waiting')">Waiting</button>
   <button onclick="setStatus(${id},'In Progress')">In Progress</button>
   <button onclick="setStatus(${id},'Complete')">Complete</button>
   <button class="danger" onclick="removePerson(${id})">Remove</button>
  </div>`;
  people.innerHTML+=html;
 });
}
</script>

</body>
</html>
